# 钱包

## 钱包类型

### 非确定性钱包

保存的每一个私钥都是通过独立的随机数生成的，私钥之间没有任何关联。

很多以太坊客户端采用 JSON 格式来保存 keystore 文件，keystore 的格式遵循密钥导出函数，也被称为增强式密钥算法。这个文件会使用密码加密，但并不是直接用密码对私钥进行加密，密码会进行连续的 hash 扩展。

### 确定性钱包

所有密钥都是从一个主密钥派生而来，主密钥就是种子密钥，这类钱包中，所有密钥都存在关联，获得了种子密钥就可以重新生成所有的密钥。

### 种子密钥 & 助记词（BIP-39）

正确的单词序列，可以重建一把独一无二的私钥，该方法由 BIP-39 标准化。

## 最佳实践

钱包标准包括：

- BIP-39 助记词标准
- BIP-32 层级式确定性钱包标准
- BIP-42 多用途层级式确定性钱包结构
- BIP-44 多币种 & 多账户钱包

### 生成助记词

1. 创建 128bit / 256bit 的随机数（S）
2. 取 S 的 SHA-256 哈希值前（S.length/32）bit，作为 S 的校验值
3. 将校验值加到 S 的末尾
4. 以 11 bit 为一组，将 S 与校验数结合成的数分为多个组
5. 将每一个 11bit 的值根据预先定义的字典映射成单词，字典包含了 2048 (2^11) 个单词
6. 保持次序，得出助记词
7. 使用 PBKDF2 来扩展助记词，生成种子密钥
   - 第一个参数为助记词
   - 第二个参数为盐（防止暴力破解，引入额外密码来保护种子密钥）
8. PBKDF2 针对助记词 & 盐进行 2048 次哈希，使用的是 HMAC-SHA512 算法，产生一个 512 位 的数字，称为种子密钥

::: warning
没有正确或错误的密码，同一组助记词对应不同密码时会生成不同的钱包。
:::
